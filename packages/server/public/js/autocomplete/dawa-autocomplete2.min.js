var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,k){a!=Array.prototype&&a!=Object.prototype&&(a[d]=k.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var k=0,g={next:function(){if(k<a.length){var b=k++;return{value:d(b,a[b]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill=function(a,d,k,g){if(d){k=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var b=a[g];b in k||(k[b]={});k=k[b]}a=a[a.length-1];g=k[a];d=d(g);d!=g&&null!=d&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var d=a[Symbol.iterator];return d?d.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function d(){this.batch_=null}function k(q){return q instanceof b?q:new b(function(a,b){a(q)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;d.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};d.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var g=$jscomp.global.setTimeout;d.prototype.asyncExecuteFunction=function(a){g(a,
0)};d.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var d=a[b];delete a[b];try{d()}catch(n){this.asyncThrow_(n)}}}this.batch_=null};d.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var b=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(x){b.reject(x)}};b.prototype.createResolveAndReject_=
function(){function a(a){return function(q){d||(d=!0,a.call(b,q))}}var b=this,d=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};b.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var d=null!=a;break a;case "function":d=!0;break a;default:d=!1}d?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};b.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(x){this.reject_(x);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};b.prototype.reject_=function(a){this.settle_(2,a)};b.prototype.fulfill_=function(a){this.settle_(1,a)};b.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};b.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var u=new d;b.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};b.prototype.settleSameAsThenable_=function(a,b){var d=this.createResolveAndReject_();try{a.call(b,d.resolve,d.reject)}catch(n){d.reject(n)}};b.prototype.then=function(a,d){function g(a,b){return"function"==typeof a?function(b){try{n(a(b))}catch(C){k(C)}}:b}var n,k,q=new b(function(a,
b){n=a;k=b});this.callWhenSettled_(g(a,n),g(d,k));return q};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.callWhenSettled_=function(a,b){function d(){switch(n.state_){case 1:a(n.result_);break;case 2:b(n.result_);break;default:throw Error("Unexpected state: "+n.state_);}}var n=this;null==this.onSettledCallbacks_?u.asyncExecute(d):this.onSettledCallbacks_.push(function(){u.asyncExecute(d)})};b.resolve=k;b.reject=function(a){return new b(function(b,d){d(a)})};b.race=function(a){return new b(function(b,
d){for(var n=$jscomp.makeIterator(a),g=n.next();!g.done;g=n.next())k(g.value).callWhenSettled_(b,d)})};b.all=function(a){var d=$jscomp.makeIterator(a),g=d.next();return g.done?k([]):new b(function(a,b){function n(b){return function(d){q[b]=d;u--;0==u&&a(q)}}var q=[],u=0;do q.push(void 0),u++,k(g.value).callWhenSettled_(n(q.length-1),b),g=d.next();while(!g.done)})};return b},"es6-impl","es3");$jscomp.owns=function(a,d){return Object.prototype.hasOwnProperty.call(a,d)};
$jscomp.polyfill("Object.assign",function(a){return a?a:function(a,k){for(var d=1;d<arguments.length;d++){var b=arguments[d];if(b)for(var u in b)$jscomp.owns(b,u)&&(a[u]=b[u])}return a}},"es6-impl","es3");var module$Input_0={};
(function(a,d){"object"===typeof module$Input_0&&"undefined"!==typeof module?d(module$Input_0):"function"===typeof define&&define.amd?define(["exports"],d):d(a.dawaAutocomplete=a.dawaAutocomplete||{})})(this,function(a){function d(){}function k(a,e){this.attrs=new d;this.attrsArr=[];this.newAttrs=new d;this.staticsApplied=!1;this.key=e;this.keyMap=new d;this.keyMapValid=!0;this.focused=!1;this.nodeName=a;this.text=null}function g(){this.created=D.nodesCreated&&[];this.deleted=D.nodesDeleted&&[]}var b=
{},u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},q=function(){function a(a,c){for(var e=0;e<c.length;e++){var b=c[e];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(e,c,r){c&&a(e.prototype,c);r&&a(e,r);return e}}(),T=Object.prototype.hasOwnProperty;d.prototype=
Object.create(null);var x=function(a,e,c){e=new k(e,c);return a.__incrementalDOMData=e},n=function(a){U(a);return a.__incrementalDOMData},U=function e(c){if(!c.__incrementalDOMData){var a=c instanceof Element,b=a?c.localName:c.nodeName,d=a?c.getAttribute("key"):null,f=x(c,b,d);d&&(n(c.parentNode).keyMap[d]=c);if(a)for(var a=c.attributes,d=f.attrs,b=f.newAttrs,f=f.attrsArr,h=0;h<a.length;h+=1){var g=a[h],m=g.name,g=g.value;d[m]=g;b[m]=void 0;f.push(m);f.push(g)}for(c=c.firstChild;c;c=c.nextSibling)e(c)}},
D={nodesCreated:null,nodesDeleted:null};g.prototype.markCreated=function(a){this.created&&this.created.push(a)};g.prototype.markDeleted=function(a){this.deleted&&this.deleted.push(a)};g.prototype.notifyChanges=function(){this.created&&0<this.created.length&&D.nodesCreated(this.created);this.deleted&&0<this.deleted.length&&D.nodesDeleted(this.deleted)};var A=!1,E=!1,F=function(a){if(A)throw Error(a+"() can not be called between elementOpenStart() and elementOpenEnd().");},C=function(a){if(E)throw Error(a+
"() may not be called inside an element that has called skip().");},L=function(a){var c=A;A=a;return c},G=function(a){var c=E;E=a;return c},w=null,m=null,p=null,B=null,M=function(a,c){for(var e=0;e<a.length;e+=1)n(a[e]).focused=c},O=function(a){return function(c,e,d){var r=w,f=B,h=m,y=p,n=!1,l=!1;w=new g;B=c.ownerDocument;p=c.parentNode;"production"!==b.NODE_ENV&&(n=L(!1),l=G(!1));var k=p;var v,t;for(v=t=c;t;)v=t,t=t.parentNode;t=v;if((v=t instanceof Document||t instanceof DocumentFragment?t.activeElement:
null)&&c.contains(v)){for(t=[];v!==k;)t.push(v),v=v.parentNode;k=t}else k=[];M(k,!0);c=a(c,e,d);M(k,!1);if("production"!==b.NODE_ENV){if(A)throw Error("elementOpenEnd() must be called after calling elementOpenStart().");L(n);G(l)}w.notifyChanges();w=r;B=f;m=h;p=y;return c}}(function(a,c,r){p=m=a;m=null;c(r);N();m=p;p=p.parentNode;if("production"!==b.NODE_ENV&&m!==a){c=m;for(r=[];c&&c!==a;)r.push(c.nodeName.toLowerCase()),c=c.parentNode;throw Error("One or more tags were not closed:\n"+r.join("\n"));
}return a}),P=function(a,c,b){a=n(a);return c===a.nodeName&&b==a.key},R=function(a,c){if(!m||!P(m,a,c)){var b=n(p),e=m&&n(m),d=b.keyMap,f=void 0;if(c){var h=d[c];h&&(P(h,a,c)?f=h:h===m?w.markDeleted(h):Q(p,h,d))}f||("#text"===a?(f=B.createTextNode(""),x(f,"#text",null)):(f=B,h=p,f=(h="svg"===a?"http://www.w3.org/2000/svg":"foreignObject"===n(h).nodeName?null:h.namespaceURI)?f.createElementNS(h,a):f.createElement(a),x(f,a,c)),c&&(d[c]=f),w.markCreated(f));if(n(f).focused)for(c=p,b=f,e=b.nextSibling,
d=m;d!==b;)a=d.nextSibling,c.insertBefore(d,e),d=a;else e&&e.key&&!e.focused?(p.replaceChild(f,m),b.keyMapValid=!1):p.insertBefore(f,m);m=f}},Q=function(a,c,b){a.removeChild(c);w.markDeleted(c);(a=n(c).key)&&delete b[a]},N=function(){var a=p,c=n(a),b=c.keyMap,d=c.keyMapValid,g=a.lastChild,f=void 0;if(g!==m||!d){for(;g!==m;)Q(a,g,b),g=a.lastChild;if(!d){for(f in b)g=b[f],g.parentNode!==a&&(w.markDeleted(g),delete b[f]);c.keyMapValid=!0}}},H=function(a,c,b){var e=n(a).attrs;e[c]!==b&&((z[c]||z.__default)(a,
c,b),e[c]=b)},z=new d;z.__default=function(a,c,b){var e="undefined"===typeof b?"undefined":u(b);"object"===e||"function"===e?a[c]=b:null==b?a.removeAttribute(c):(e=0===c.lastIndexOf("xml:",0)?"http://www.w3.org/XML/1998/namespace":0===c.lastIndexOf("xlink:",0)?"http://www.w3.org/1999/xlink":void 0,e?a.setAttributeNS(e,c,b):a.setAttribute(c,b))};z.style=function(a,c,b){if("string"===typeof b)a.style.cssText=b;else{a.style.cssText="";a=a.style;for(var e in b)if(T.call(b,e)){c=a;var d=e,f=b[e];0<=d.indexOf("-")?
c.setProperty(d,f):c[d]=f}}};var I=function(a,c,d,g){"production"!==b.NODE_ENV&&(F("elementOpen"),C("elementOpen"));m=m?m.nextSibling:p.firstChild;R(a,c);p=m;m=null;var e=p;var f=n(e);if(!f.staticsApplied){if(d)for(var h=0;h<d.length;h+=2){var r=d[h];var y=d[h+1];H(e,r,y)}f.staticsApplied=!0}h=f.attrsArr;f=f.newAttrs;r=!h.length;for(var l=3,k=0;l<arguments.length;l+=2,k+=2){var v=arguments[l];if(r)h[k]=v,f[v]=void 0;else if(h[k]!==v)break;y=arguments[l+1];if(r||h[k+1]!==y)h[k+1]=y,H(e,v,y)}if(l<arguments.length||
k<h.length){for(;l<arguments.length;l+=1,k+=1)h[k]=arguments[l];k<h.length&&(h.length=k);for(l=0;l<h.length;l+=2)r=h[l],y=h[l+1],f[r]=y;for(var t in f)H(e,t,f[t]),f[t]=void 0}return e},J=function(a){"production"!==b.NODE_ENV&&F("elementClose");"production"!==b.NODE_ENV&&G(!1);N();m=p;p=p.parentNode;var c=m;if("production"!==b.NODE_ENV){var d=n(c).nodeName;if(d!==a)throw Error('Received a call to close "'+a+'" but "'+d+'" was open.');}return c},V=function(a,c,b,d){I.apply(null,arguments);return J(a)},
K=function(a,c){"production"!==b.NODE_ENV&&(F("text"),C("text"));m=m?m.nextSibling:p.firstChild;R("#text",null);var d=m;var e=n(d);if(e.text!==a){for(var e=e.text=a,g=1;g<arguments.length;g+=1)e=(0,arguments[g])(e);d.data=e}return d},S=z;S.caretpos=function(a,c,b){a.setSelectionRange(b,b)};S.value=function(a,c,b){a[c]=b};var W=function(a,c,b){if(0<a.suggestions.length&&a.focused){I("ul","",["class","dawa-autocomplete-suggestions","role","listbox"]);for(var d=function(d){var e=a.suggestions[d],f="dawa-autocomplete-suggestion";
a.selected===d&&(f+=" dawa-selected");I("li","",["role","option"],"class",f,"onmousedown",function(a){c(d);a.preventDefault()});e=e.forslagstekst.split("\n");e=e.map(function(a){return a.replace(/ /g,"\u00a0")});if(b)for(K(e[0]),f=1;f<e.length;++f)V("br"),K(e[f]);else K(e.join(", "));J("li")},e=0;e<a.suggestions.length;++e)d(e);J("ul")}},X=function(a,c,b,d){O(a,function(){W(c,b,d)})},Y=function(a,c){var b=c.onSelect,d=c.onTextChange,e=c.render||X,f=!1,h="",g=0,k=document.createElement("div");a.parentNode.insertBefore(k,
a.nextSibling);var l={caretpos:2,inputText:"",selected:0,focused:document.activeElement===a,suggestions:[]},n=function(a){var c=a.value;a=a.selectionStart;l.caretpos=a;l.inputText=c;if(h!==c||g!==a)d(c,a),h=c,g=a},m=void 0,p=function(a){a=l.suggestions[a];l.inputText=a.tekst;l.caretpos=a.caretpos;l.suggestions=[];b(a);m(!0)},q=function(a){var c=window.event?a.keyCode:a.which;if(0<l.suggestions.length&&l.focused){if(40===c)l.selected=(l.selected+1)%l.suggestions.length,m();else if(38===c)l.selected=
(l.selected-1+l.suggestions.length)%l.suggestions.length,m();else if(13===c||9===c)p(l.selected);else return!0;a.preventDefault();return!1}},u=function(){l.focused=!0;m()},w=function(){l.focused=!1;m();return!1},x=function(a){n(a.target)},B=function(a){return n(a.target)},z=!1,A=!1,m=function(b){b&&(A=!0);z||(z=!0,requestAnimationFrame(function(){f||(z=!1,A&&(a.value=l.inputText,a.setSelectionRange(l.caretpos,l.caretpos)),A=!1,e(k,l,function(a){return p(a)},c.multiline))}))};m();a.addEventListener("keydown",
q);a.addEventListener("blur",w);a.addEventListener("focus",u);a.addEventListener("input",x);a.addEventListener("mouseup",B);a.setAttribute("aria-autocomplete","list");a.setAttribute("autocomplete","off");return{destroy:function(){f=!0;a.removeEventListener("keydown",q);a.removeEventListener("blur",w);a.removeEventListener("focus",u);a.removeEventListener("input",x);a.removeEventListener("mouseup",B);O(k,function(){});k.remove()},setSuggestions:function(a){l.suggestions=a;l.selected=0;m()},selectAndClose:function(a){l.inputText=
a;l.caretpos=a.length;l.suggestions=[];l.selected=0;m(!0)}}},Z=function(a){return Object.keys(a).map(function(c){return c+"\x3d"+encodeURIComponent(a[c])}).join("\x26")},aa=function(a){return new Promise(function(c){return setTimeout(c,a)})},ba={params:{},minLength:2,retryDelay:500,renderCallback:function(){console.error("No renderCallback supplied")},initialRenderCallback:function(){console.error("No initialRenderCallback supplied")},type:"adresse",baseUrl:"https://dawa.aws.dk",adgangsadresserOnly:!1,
stormodtagerpostnumre:!0,supplerendebynavn:!0,fuzzy:!0,fetchImpl:function(a,c){return fetch(a+"?"+Z(c),{mode:"cors"}).then(function(a){return a.json()})}},ca=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.options=c=Object.assign({},ba,c||{});this.state={currentRequest:null,pendingRequest:null};this.selected=null}q(a,[{key:"_getAutocompleteResponse",value:function(a,b,d,e,f,h){a=Object.assign({},this.options.params,{q:a,type:this.options.type,
caretpos:b,supplerendebynavn:f,stormodtagerpostnumre:h,multilinje:!0});this.options.fuzzy&&(a.fuzzy="");e&&(a.adgangsadresseid=e);d&&(a.startfra="adgangsadresse");return this.options.fetchImpl(this.options.baseUrl+"/autocomplete",a)}},{key:"_scheduleRequest",value:function(a){null!==this.state.currentRequest?this.state.pendingRequest=a:(this.state.currentRequest=a,this._executeRequest())}},{key:"_executeRequest",value:function(){var a=this,b=this.state.currentRequest,d=null,e=!1,f=void 0,h=void 0;
if(b.selected)if(h=b.selected,h.type!==this.options.type)d="adgangsadresse"===h.type?h.data.id:null,e="vejnavn"===h.type,f=h.tekst,h=h.caretpos;else{this.options.selectCallback(h);this.selected=h;this._requestCompleted();return}else f=b.text,h=b.caretpos;if(b.selectedId)return this.options.fetchImpl(this.options.baseUrl+"/autocomplete",{id:b.selectedId,type:this.options.type}).then(function(c){return a._handleResponse(b,c)},function(c){return a._handleFailedRequest(b,c)});b.selected||b.text.length>=
this.options.minLength?this._getAutocompleteResponse(f,h,e,d,this.options.supplerendebynavn,this.options.stormodtagerpostnumre).then(function(c){return a._handleResponse(b,c)},function(c){return a._handleFailedRequest(b,c)}):this._handleResponse(b,[])}},{key:"_handleFailedRequest",value:function(a,b){var c=this;console.error("DAWA request failed",b);return aa(this.options.retryDelay).then(function(){c.state.pendingRequest||c._scheduleRequest(a);c._requestCompleted()})}},{key:"_handleResponse",value:function(a,
b){a.selected?1===b.length?(a=b[0],a.type===this.options.type?this.options.selectCallback(a):this.state.pendingRequest||(this.state.pendingRequest={selected:a})):this.options.renderCallback&&this.options.renderCallback(b):a.selectedId?1===b.length&&(this.selected=b[0],this.options.initialRenderCallback(b[0].tekst)):this.options.renderCallback&&this.options.renderCallback(b);this._requestCompleted()}},{key:"_requestCompleted",value:function(){this.state.currentRequest=this.state.pendingRequest;this.state.pendingRequest=
null;this.state.currentRequest&&this._executeRequest()}},{key:"setRenderCallback",value:function(a){this.options.renderCallback=a}},{key:"setInitialRenderCallback",value:function(a){this.options.initialRenderCallback=a}},{key:"setSelectCallback",value:function(a){this.options.selectCallback=a}},{key:"update",value:function(a,b){this._scheduleRequest({text:a,caretpos:b})}},{key:"select",value:function(a){this._scheduleRequest({selected:a})}},{key:"selectInitial",value:function(a){this._scheduleRequest({selectedId:a})}},
{key:"destroy",value:function(){}}]);return a}();a.dawaAutocomplete=function(a,b){b=Object.assign({select:function(){return null}},b);var c="baseUrl minLength params fuzzy stormodtagerpostnumre supplerendebynavn".split(" ").reduce(function(a,c){b.hasOwnProperty(c)&&(a[c]=b[c]);return a},{});c.type=b.adgangsadresserOnly?"adgangsadresse":"adresse";var d=new ca(c),e=Y(a,{onSelect:function(a){d.select(a)},onTextChange:function(a,b){d.update(a,b)},render:b.render,multiline:b.multiline||!1});d.setRenderCallback(function(a){return e.setSuggestions(a)});
d.setSelectCallback(function(a){e.selectAndClose(a.tekst);b.select(a)});d.setInitialRenderCallback(function(a){return e.selectAndClose(a)});b.id&&d.selectInitial(b.id);return{id:function(a){return d.selectInitial(a)},destroy:function(){return e.destroy()},selected:function(){return d.selected}}};Object.defineProperty(a,"__esModule",{value:!0})});
